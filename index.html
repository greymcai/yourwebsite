<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Website Project Onboarding</title>
  <!-- Styles omitted for brevity (same as before) -->
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ðŸš€ Website Project Onboarding</h1>
      <p>Tell us about your project and we'll create a custom website prompt for you</p>
    </div>

    <div class="form-container">
      <form id="onboardingForm"
            action="https://formsubmit.co/greymc041.ai@gmail.com"
            method="POST"
            enctype="multipart/form-data">

        <!-- Subject now set dynamically -->
        <input type="hidden" name="_subject" id="_subject" value="" />
        <input type="hidden" name="_captcha" value="false" />
        <input type="hidden" name="_template" value="table" />
        <input type="hidden" name="_next" value="data:text/html,<html><head><title>Success</title></head><body style='font-family:Arial,sans-serif;text-align:center;padding:50px;background:linear-gradient(135deg,%23667eea%200%25,%23764ba2%20100%25);color:white;'><div style='background:white;color:%23333;padding:40px;border-radius:20px;box-shadow:0%2020px%2040px%20rgba(0,0,0,0.1);max-width:520px;margin:0%20auto;'><h2 style='color:%234f46e5;margin-bottom:20px;'>âœ… Thank You!</h2><p style='font-size:18px;margin-bottom:30px;'>Your website project details have been submitted successfully. We'll review your information and get back to you soon!</p><button onclick='window.close()' style='background:%234f46e5;color:white;border:none;padding:15px%2030px;border-radius:8px;font-size:16px;cursor:pointer;'>Close Window</button></div></body></html>" />
        <input type="text" name="_honey" class="sr-only" tabindex="-1" autocomplete="off" />
        <textarea id="website_prompt" name="website_prompt" class="sr-only" aria-hidden="true"></textarea>

        <!-- Rest of form fields (same as before) -->

        <button type="submit" class="submit-btn" id="submitBtn">
          <span id="btnText">ðŸš€ Submit & Generate Prompt</span>
          <span id="btnLoader" class="loading" style="display:none"></span>
        </button>
        <div id="errorMessage" class="error-message" role="alert"></div>
      </form>
    </div>
  </div>

  <script>
    function toggleCustomColors() {
      const select = document.getElementById('brandColorsSelect');
      const customInput = document.getElementById('customBrandColors');
      if (select.value === 'custom') {
        customInput.style.display = 'block';
        customInput.setAttribute('required', 'true');
        customInput.focus();
      } else {
        customInput.style.display = 'none';
        customInput.removeAttribute('required');
        customInput.value = '';
      }
    }
    document.getElementById('brandColorsSelect').addEventListener('change', toggleCustomColors);

    // Same generatePrompt function as before...

    function validateFiles(form) {
      const MAX_EACH = 10 * 1024 * 1024;
      const MAX_TOTAL = 50 * 1024 * 1024;
      let total = 0;
      const inputs = ['businessLogo', 'productImages', 'brandMaterials'];
      for (const name of inputs) {
        const el = form.querySelector(`input[name="${name}"]`);
        if (!el || !el.files) continue;
        for (const f of el.files) {
          if (f.size > MAX_EACH) {
            return `File "${f.name}" exceeds 10MB limit.`;
          }
          total += f.size;
          if (total > MAX_TOTAL) {
            return 'Total upload size exceeds 50MB limit.';
          }
        }
      }
      return '';
    }

    const formEl = document.getElementById('onboardingForm');
    const submitBtn = document.getElementById('submitBtn');
    const btnText = document.getElementById('btnText');
    const btnLoader = document.getElementById('btnLoader');
    const errorBox = document.getElementById('errorMessage');

    formEl.addEventListener('submit', (e) => {
      const fd = new FormData(formEl);
      const fileErr = validateFiles(formEl);
      if (fileErr) {
        e.preventDefault();
        errorBox.textContent = fileErr;
        errorBox.style.display = 'block';
        return;
      }

      const colorMode = fd.get('brandColorsSelect');
      const customVal = (fd.get('customBrandColors') || '').trim();
      if (colorMode === 'custom' && !customVal) {
        e.preventDefault();
        errorBox.textContent = 'Please provide your custom brand colors.';
        errorBox.style.display = 'block';
        document.getElementById('customBrandColors').focus();
        return;
      }

      const prompt = generatePrompt(fd);
      document.getElementById('website_prompt').value = prompt;

      // Dynamically set subject line
      const businessName = fd.get('businessName') || 'Unknown Business';
      document.getElementById('_subject').value = `${businessName} - New Website Project Onboarding`;

      errorBox.style.display = 'none';
      submitBtn.disabled = true;
      btnText.textContent = 'Sendingâ€¦';
      btnLoader.style.display = 'inline-block';
    });
  </script>
</body>
</html>
